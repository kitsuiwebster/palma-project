<!-- Image Lightbox Modal -->
<div class="lightbox-overlay" 
     *ngIf="isVisible" 
     (click)="onBackdropClick($event)">
  
  <div class="lightbox-container">
    <!-- Main Image -->
    <div class="image-container">
      <!-- Close Button (now inside image container) -->
      <button class="close-button" (click)="onClose()" aria-label="Close">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      <!-- Loading Spinner -->
      <div *ngIf="imageLoading" class="image-loader">
        <div class="spinner"></div>
        <span>Loading image...</span>
      </div>
      
      <img [src]="currentImageUrl" 
           [alt]="speciesName + ' photo'" 
           class="lightbox-image"
           [class.loading]="imageLoading"
           (load)="onImageLoad()"
           (error)="onImageError()">
      
      <!-- Navigation Buttons -->
      <button *ngIf="canNavigatePrevious" 
              class="nav-button nav-button-prev" 
              (click)="previousImage()"
              aria-label="Previous image">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M15 18L9 12l6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      
      <button *ngIf="canNavigateNext" 
              class="nav-button nav-button-next" 
              (click)="nextImage()"
              aria-label="Next image">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>

    <!-- Image Info Bar -->
    <div class="image-info">
      <div class="image-details">
        <h3 class="species-title">{{ speciesName }}</h3>
        <div *ngIf="imageUrls.length > 1" class="image-counter">
          {{ currentIndex + 1 }} / {{ imageUrls.length }}
        </div>
        
        <!-- Photo Credit Information -->
        <div *ngIf="photoCredit; else noCredit" class="credit-info">
          <div class="photographer">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z" stroke="currentColor" stroke-width="2"/>
              <circle cx="12" cy="13" r="4" stroke="currentColor" stroke-width="2"/>
            </svg>
            <span>{{ photoCredit.photographer }}</span>
          </div>
          
          <div class="license-info">
            <div class="license-badge" [class.warning]="getLicenseInfo()?.warning">
              {{ getLicenseInfo()?.name }}
            </div>
            <span *ngIf="getLicenseInfo()?.description" class="license-desc">
              {{ getLicenseInfo()?.description }}
            </span>
          </div>
          
          <div class="source-badge" [ngClass]="photoCredit.source.toLowerCase()">
            {{ photoCredit.source }}
          </div>
        </div>
        
        <ng-template #noCredit>
          <div class="no-credit">
            <span>Photo information not available</span>
          </div>
        </ng-template>
      </div>

      <!-- Download Button -->
      <button class="download-button" (click)="downloadImage()" aria-label="Download image">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Download
      </button>
    </div>
  </div>
</div>